// SPDX-License-Identifier: (GPL-2.0 OR MIT)
/*
 * Copyright 2020 Compass Electronics Group, LLC
 */

/dts-v1/;

#include "fsl-imx8mm.dtsi"
#include "beacon-imx8mm-som.dtsi"
#include "beacon-imx8mm-baseboard.dtsi"

/ {
	model = "beacon EmbeddedWorks i.MX8M mini Developent Kit";
	compatible = "fsl,imx8mm";

	chosen {
		stdout-path = &uart2;
	};

	reg_hdmi_1p2: regulator-hdmi-avdd {
		compatible = "regulator-fixed";
		regulator-name = "hdmi_v1p2";
		regulator-min-microvolt = <1200000>;
		regulator-max-microvolt = <1200000>;
	};

	reg_hdmi_avdd: regulator-hdmi-avdd {
		compatible = "regulator-fixed";
		regulator-name = "hdmi_avdd";
		regulator-min-microvolt = <1800000>;
		regulator-max-microvolt = <1800000>;
	};

	reg_hdmi_dvdd: regulator-hdmi-dvdd {
		pinctrl-names = "default";
		pinctrl-0 = <&pinctrl_hdmi>;
		compatible = "regulator-fixed";
		regulator-name = "hdmi_pwr_en";
		regulator-min-microvolt = <3300000>;
		regulator-max-microvolt = <3300000>;
		gpio = <&gpio2 11 GPIO_ACTIVE_HIGH>;
		enable-active-high;
		startup-delay-us = <70000>;
	};
};

&i2c2 {
	adv_bridge: adv7535@3d {
		compatible = "adi,adv7533";
		reg = <0x3d>;
		avdd-supply = <&reg_hdmi_avdd>;
		a2vdd-supply = <&reg_hdmi_avdd>;
		dvdd-supply = <&reg_hdmi_dvdd>;
		pvdd-supply = <&reg_hdmi_avdd>;
		v1p2-supply = <&reg_hdmi_1p2>;
		v3p3-supply = <&reg_hdmi_dvdd>;
		adi,addr-cec = <0x3b>;
		adi,dsi-lanes = <4>;
		pinctrl-names = "default";
		pinctrl-0 = <&pinctrl_synaptics_dsx_io>;
		interrupt-parent = <&gpio1>;
		interrupts = <9 IRQ_TYPE_LEVEL_LOW>;
		status = "okay";

		port {
			adv7535_from_dsim: endpoint {
				remote-endpoint = <&dsim_to_adv7535>;
			};
		};
	};
};

&lcdif {
	status = "okay";
};

&mipi_dsi {
	status = "okay";

	port@1 {
		dsim_to_adv7535: endpoint {
			remote-endpoint = <&adv7535_from_dsim>;
		};
	};
};

&iomuxc {
	pinctrl_hdmi: lvdsgrp {
		fsl,pins = <
			MX8MM_IOMUXC_SD1_STROBE_GPIO2_IO11              0x16
		>;
	};

	pinctrl_synaptics_dsx_io: synaptics_dsx_iogrp {
		fsl,pins = <
			MX8MM_IOMUXC_GPIO1_IO09_GPIO1_IO9		0x19
		>;
	};
};
